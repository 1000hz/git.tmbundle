<% @diff_line_count = 0 %>
<% revision ||= nil %>
<code>
  <% diff_results.each do |diff_result| %>
    <% next if @diff_line_count >= Git::DEFAULT_DIFF_LIMIT %>
    <% render "diff/_diff_result", :locals => {:diff_result => diff_result, :revision => revision } %>
    <% flush %>
  <% end %>
</code>
<% if @diff_line_count >= Git::DEFAULT_DIFF_LIMIT %>
  <h2>Diff taking to long to render... aborted</h2>
<% end %>